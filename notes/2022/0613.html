<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>orange/note: Arch Linuxで最新のAWS CLI v2をインストールする</title><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="author" content="http://www.hatena.ne.jp/lufiabb/"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/1b15737708df434c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1b15737708df434c.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-59c5c889f52620d6.js" defer=""></script><script src="/_next/static/chunks/framework-c2e8b39087850489.js" defer=""></script><script src="/_next/static/chunks/main-7715c9ce3e92f40f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8e84d751e7e95936.js" defer=""></script><script src="/_next/static/chunks/245-02c6405e66663b10.js" defer=""></script><script src="/_next/static/chunks/pages/%5B%5B...slug%5D%5D-663c09fbf665935a.js" defer=""></script><script src="/_next/static/uudkrhSA2meQW-38gm1fk/_buildManifest.js" defer=""></script><script src="/_next/static/uudkrhSA2meQW-38gm1fk/_ssgManifest.js" defer=""></script></head><body><div id="__next">
<nav>
	<h1>メニュー</h1>
	<ul>
	<li><a href="/notes/index.html"><a>orange/note</a></a></li>
	<li><a href="/notes/pc.html"><a>PC関連</a></a></li>
	<li><a href="/notes/web.html"><a>web製作</a></a></li>
	<li><a href="/notes/sec.html"><a>セキュリティ</a></a></li>
	<li><a href="/notes/hobby.html"><a>本・ゲーム</a></a></li>
	<li><a href="/notes/junk.html"><a>ジャンク</a></a></li>
	</ul>
</nav>
<main>
	<p class="revision">2022年6月13日作成</p>
	<section>
		<h1>Arch Linuxで最新のAWS CLI v2をインストールする</h1>
		<p>AWS CloudWatchのログをみるとき、今まではAURの<strong>awslogs</strong>を使っていたけど、
		6/10頃から<em>pacman -Syu</em>したときに以下のエラーで失敗するようになった。</p>
		<pre><code class="console">$ sudo pacman -Syu
:: Synchronizing package databases...
core is up to date
extra is up to date
community is up to date
:: Starting full system upgrade...
resolving dependencies...
looking for conflicting packages...
error: failed to prepare transaction (could not satisfy dependencies)
:: installing python-jmespath (1.0.0-1) breaks dependency &#x27;python-jmespath&lt;1.0.0&#x27; required by awslogs</code></pre>
		<p>AWS CLI v2にある<em>aws logs tail</em>コマンドで<strong>awslogs</strong>相当のことが行えるらしいが、
		Arch LinuxのCommunityパッケージにある<strong>aws-cli</strong>はv1で、
		AURにある<strong>aws-cli-v2</strong>はバージョンが古く、どちらも要件を満たせない。</p>
		<ul>
		<li><a href="https://www.archlinux.jp/packages/community/any/aws-cli/">aws-cli</a></li>
		<li><a href="https://aur.archlinux.org/packages/aws-cli-v2">aws-cli-v2</a></li>
		</ul>
		<p>次に、<a href="https://dev.classmethod.jp/articles/install-aws-cli-v2-from-sourcecode/">AWS CLI v2をpipからインストールしてみた</a>を参考に<em>pip</em>で試すと、
		2022年時点では<strong>botocore</strong>の<strong>v2</strong>ブランチに動きがなく、
		Cのソースファイルをビルドするところでエラーになったので諦めた。</p>
		<p>仕方がないのでバイナリパッケージを入れる。</p>
		<pre><code class="console"># 古いコマンドは消しておく
$ sudo pacman -Rs awslogs aws-cli

$ curl https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip -o awscliv2.zip
$ unzip awscliv2.zip
$ ./aws/install -i ~/pkg/aws -b ~/bin</code></pre>
		<p>これで、Arch Linuxの標準では<strong>~/.local/bin</strong>に<em>aws</em>コマンドがインストールされる。
		アップデートする場合は、新しいインストーラをダウンロードして<em>install -u</em>するといいらしい。</p>
		<p>これを調べている時に知ったけど、今は<em>python -mpip</em>とするらしい。
		また、GitHubのURLを渡すと直接インストールできる。</p>
		<pre><code class="console">$ python -m pip install git+https://github.com/aws/aws-cli.git@v2

# アーカイブの場合はこれ
$ python -m pip install https://github.com/aws/aws-cli/archive/v2.tar.gz</code></pre>
	</section>
</main>
<aside>
	<h1>やっていること</h1>
	<ul>
	<li><a href="/plan9/index.html"><a>Plan 9</a></a></li>
	<li><a href="http://web.me.com/lufia/alefcompiler/alef/">Alefコンパイラを読む</a></li>
	</ul>
</aside>
<footer>
	<p>見れない、表示がおかしい場合は、動作環境を添えて<a href="/notes/2022/mailto:webmaster@lufia.org"><a>webmaster@lufia.org</a></a>まで連絡ください。</p>
</footer>
</div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"html":"\u003c!doctype html\u003e\n\u003chtml lang=\"ja\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003ctitle\u003eorange/note: Arch Linuxで最新のAWS CLI v2をインストールする\u003c/title\u003e\n\u003cmeta name=\"viewport\" content=\"width=device-width,initial-scale=1\"\u003e\n\u003cmeta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cnav\u003e\n\t\u003ch1\u003eメニュー\u003c/h1\u003e\n\t\u003cul\u003e\n\t\u003cli\u003e\u003ca href=\"/notes/index.html\"\u003eorange/note\u003c/a\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003ca href=\"/notes/pc.html\"\u003ePC関連\u003c/a\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003ca href=\"/notes/web.html\"\u003eweb製作\u003c/a\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003ca href=\"/notes/sec.html\"\u003eセキュリティ\u003c/a\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003ca href=\"/notes/hobby.html\"\u003e本・ゲーム\u003c/a\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003ca href=\"/notes/junk.html\"\u003eジャンク\u003c/a\u003e\u003c/li\u003e\n\t\u003c/ul\u003e\n\u003c/nav\u003e\n\u003cmain\u003e\n\t\u003cp class=\"revision\"\u003e2022年6月13日作成\u003c/p\u003e\n\t\u003csection\u003e\n\t\t\u003ch1\u003eArch Linuxで最新のAWS CLI v2をインストールする\u003c/h1\u003e\n\t\t\u003cp\u003eAWS CloudWatchのログをみるとき、今まではAURの\u003cstrong\u003eawslogs\u003c/strong\u003eを使っていたけど、\n\t\t6/10頃から\u003cem\u003epacman -Syu\u003c/em\u003eしたときに以下のエラーで失敗するようになった。\u003c/p\u003e\n\t\t\u003cpre\u003e\u003ccode class=\"console\"\u003e$ sudo pacman -Syu\n:: Synchronizing package databases...\ncore is up to date\nextra is up to date\ncommunity is up to date\n:: Starting full system upgrade...\nresolving dependencies...\nlooking for conflicting packages...\nerror: failed to prepare transaction (could not satisfy dependencies)\n:: installing python-jmespath (1.0.0-1) breaks dependency 'python-jmespath\u0026lt;1.0.0' required by awslogs\u003c/code\u003e\u003c/pre\u003e\n\t\t\u003cp\u003eAWS CLI v2にある\u003cem\u003eaws logs tail\u003c/em\u003eコマンドで\u003cstrong\u003eawslogs\u003c/strong\u003e相当のことが行えるらしいが、\n\t\tArch LinuxのCommunityパッケージにある\u003cstrong\u003eaws-cli\u003c/strong\u003eはv1で、\n\t\tAURにある\u003cstrong\u003eaws-cli-v2\u003c/strong\u003eはバージョンが古く、どちらも要件を満たせない。\u003c/p\u003e\n\t\t\u003cul\u003e\n\t\t\u003cli\u003e\u003ca href=\"https://www.archlinux.jp/packages/community/any/aws-cli/\"\u003eaws-cli\u003c/a\u003e\u003c/li\u003e\n\t\t\u003cli\u003e\u003ca href=\"https://aur.archlinux.org/packages/aws-cli-v2\"\u003eaws-cli-v2\u003c/a\u003e\u003c/li\u003e\n\t\t\u003c/ul\u003e\n\t\t\u003cp\u003e次に、\u003ca href=\"https://dev.classmethod.jp/articles/install-aws-cli-v2-from-sourcecode/\"\u003eAWS CLI v2をpipからインストールしてみた\u003c/a\u003eを参考に\u003cem\u003epip\u003c/em\u003eで試すと、\n\t\t2022年時点では\u003cstrong\u003ebotocore\u003c/strong\u003eの\u003cstrong\u003ev2\u003c/strong\u003eブランチに動きがなく、\n\t\tCのソースファイルをビルドするところでエラーになったので諦めた。\u003c/p\u003e\n\t\t\u003cp\u003e仕方がないのでバイナリパッケージを入れる。\u003c/p\u003e\n\t\t\u003cpre\u003e\u003ccode class=\"console\"\u003e# 古いコマンドは消しておく\n$ sudo pacman -Rs awslogs aws-cli\n\n$ curl https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip -o awscliv2.zip\n$ unzip awscliv2.zip\n$ ./aws/install -i ~/pkg/aws -b ~/bin\u003c/code\u003e\u003c/pre\u003e\n\t\t\u003cp\u003eこれで、Arch Linuxの標準では\u003cstrong\u003e~/.local/bin\u003c/strong\u003eに\u003cem\u003eaws\u003c/em\u003eコマンドがインストールされる。\n\t\tアップデートする場合は、新しいインストーラをダウンロードして\u003cem\u003einstall -u\u003c/em\u003eするといいらしい。\u003c/p\u003e\n\t\t\u003cp\u003eこれを調べている時に知ったけど、今は\u003cem\u003epython -mpip\u003c/em\u003eとするらしい。\n\t\tまた、GitHubのURLを渡すと直接インストールできる。\u003c/p\u003e\n\t\t\u003cpre\u003e\u003ccode class=\"console\"\u003e$ python -m pip install git+https://github.com/aws/aws-cli.git@v2\n\n# アーカイブの場合はこれ\n$ python -m pip install https://github.com/aws/aws-cli/archive/v2.tar.gz\u003c/code\u003e\u003c/pre\u003e\n\t\u003c/section\u003e\n\u003c/main\u003e\n\u003caside\u003e\n\t\u003ch1\u003eやっていること\u003c/h1\u003e\n\t\u003cul\u003e\n\t\u003cli\u003e\u003ca href=\"/plan9/index.html\"\u003ePlan 9\u003c/a\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003ca href=\"http://web.me.com/lufia/alefcompiler/alef/\"\u003eAlefコンパイラを読む\u003c/a\u003e\u003c/li\u003e\n\t\u003c/ul\u003e\n\u003c/aside\u003e\n\u003cfooter\u003e\n\t\u003cp\u003e見れない、表示がおかしい場合は、動作環境を添えて\u003ca href=\"mailto:webmaster@lufia.org\"\u003ewebmaster@lufia.org\u003c/a\u003eまで連絡ください。\u003c/p\u003e\n\u003c/footer\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/[[...slug]]","query":{"slug":["notes","2022","0613"]},"buildId":"uudkrhSA2meQW-38gm1fk","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>