{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>Plan 9: 2chファイルサーバ</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"/plan9/doc/inst/index.html\">インストール</a></li>\n\t<li><a href=\"/plan9/doc/guide/index.html\">システムの使い方</a></li>\n\t<li><a href=\"/plan9/doc/devel/index.html\">プログラミング</a></li>\n\t<li><a href=\"/plan9/doc/adm/index.html\">システム管理</a></li>\n\t<li><a href=\"/plan9/man/index.html\">自作ツール集</a></li>\n\t</ul>\n</nav>\n<main>\n\t<h1>monafs</h1>\n\t<section>\n\t\t<h2>SYNOPSIS</h2>\n\t\t<pre><code>monafs [-dv] [-m mtpt] [-s srv]</code></pre>\n\t</section>\n\t<section>\n\t\t<h2>OPTIONS</h2>\n\t\t<dl>\n\t\t<div>\n\t\t\t<dt>d</dt>\n\t\t\t<dd>デバッグ文を有効にします。</dd>\n\t\t</div>\n\t\t<div>\n\t\t\t<dt>m mtpt</dt>\n\t\t\t<dd>mtptをマウントポイントとして使用します。</dd>\n\t\t\t<dd>指定がなければ/n/2chを使います。</dd>\n\t\t</div>\n\t\t<div>\n\t\t\t<dt>s srv</dt>\n\t\t\t<dd>/srv以下にサービスファイルを作成します。</dd>\n\t\t</div>\n\t\t<div>\n\t\t\t<dt>v</dt>\n\t\t\t<dd>進行状況をstderrに書き出します。</dd>\n\t\t\t<dd>デバッグ文とはまた違う出力になります。</dd>\n\t\t</div>\n\t\t</dl>\n\t</section>\n\t<section>\n\t\t<h2>INSTALL</h2>\n\t\t<p><a href=\"http://lufia.org/plan9/src/libkanji.tgz\">libkanji</a>が必要です。\n\t\tあらかじめインストールしておいてください。\n\t\tまたは、monafsに付属する以下の関数をいじれば、libtcsでも大丈夫です。</p>\n\t\t<ul>\n\t\t<li>util.c:sjistostring</li>\n\t\t<li>util.c:Ufmt</li>\n\t\t</ul>\n\t\t<p>libtcs (半角カナ対応版)\n\t\t<a href=\"http://c.p9c.info/plan9/\">http://c.p9c.info/plan9/</a></p>\n\t\t<p>また、書き込み機能が必要な場合には、\n\t\t<a href=\"https://9p.io/magic/man2html/4/webfs\">webfs(4)</a>をreferer送信に対応させることが必須です。\n\t\t同封のwebfs.diffを当てたものを作成しておいてください。</p>\n\t\t<p class=\"note\">これは古いです。おそらくパッチも当たらないでしょうし、\n\t\t当てたとしても2chの仕様も変わってしまったため、\n\t\t書き込みはできないと思われます。</p>\n\t\t<p>準備ができたら、</p>\n\t\t<pre><code>% mk\n% mk install</code></pre>\n\t\t<p>これで、$home/bin/$objtype以下にインストールされます。\n\t\tマウントポイントに/n/2chを使うので、\n\t\tなければそれも作っておいてください。</p>\n\t\t<pre><code># 実際に作成する場合\n% mkdir /n/2ch\n% chgrp -u sys /n/2ch\n\n# 動的に生成する場合(こちらがおすすめ)\n% mntgen</code></pre>\n\t</section>\n\t<section>\n\t\t<h2>FILES</h2>\n\t\t<p>マウント後のファイル構造は以下のようになっています。</p>\n\t\t<pre><code>category/ (1からn)\n\tsubject\n\tboard/ (例えばunix)\n\t\tctl\n\t\tpost\n\t\tsubject\n\t\tthread/ (1029374722)\n\t\t\tctl\n\t\t\tpost\n\t\t\tsubject\n\t\t\tarticle/ (1から1000)\n\t\t\t\tfrom\n\t\t\t\tmail\n\t\t\t\tdate (YYYY/MM/DD HH:MM:SS)\n\t\t\t\tid\n\t\t\t\tbe\n\t\t\t\tmessage</code></pre>\n\t\t<p>これらは必ず作成されます。\n\t\t内容が無い場合は、空ファイルになっています。</p>\n\t\t<p>全てのsubjectと、from、articleの内容は、\n\t\t実体参照(例えば&amp;lt;&amp;gt;)や文字符号(&amp;#1234;)が、\n\t\t通常の文字(例えば&lt;&gt;)へと変換されています。\n\t\tまたmailの内容は、%HH形式の16進コードを\n\t\tそれが対応する文字へと変換します。</p>\n\t\t<p>dateはタイムゾーンの設定によって変わってきますが、\n\t\tその値はどれも同じ時間を表します。\n\t\t例えばタイムゾーンをJSTに設定すれば、\n\t\t2ちゃんねるに表示される時間と同じ値になります。\n\t\tまた、あぼーんや[ここ壊れています]の場合には、\n\t\t1970/01/01 09:00(time=0の時刻)となります。</p>\n\t\t<p class=\"note\">皇暦など、通常ではない時間の場合には不具合が出るかもしれません。</p>\n\t\t<p>ctlへrefreshと書くと、板またはスレッドを読みなおします。\n\t\tまた、ctlを読むと、スレッドや板の詳細が入っています。\n\t\t共通して、文字の区切りはスペース(0x20)1つです。</p>\n\t\t<section>\n\t\t\t<h3>board/ctl</h3>\n\t\t\t<pre><code>host server.domain.dom</code></pre>\n\t\t\t<p>その板のあるホスト名が入ります。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>thread/ctl</h3>\n\t\t\t<pre><code>rank XXXX\narticle XXXX</code></pre>\n\t\t\t<p>rankはスレッド一覧の表示順位を持ちます。\n\t\t\t1が最新(上)で、順に下がっていきます。\n\t\t\tarticleは、そのスレッドに書き込みされたレス数です。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>thread/post</h3>\n\t\t\t<p>ここへ書くと、それを書き込みとして処理します。</p>\n\t\t\t<pre><code>from:no name\nmail:mail address\nraw text...</code></pre>\n\t\t\t<p>fromは書き込みした人の名前で、mailはメールアドレスです。\n\t\t\tfrom:またはmail:が先頭の行のみ、属性と認識されます。\n\t\t\tそれ以外が現れた行以降は、ただのテキストと判断します。\n\t\t\tfrom,mailを省略すると、空文字列が補われます。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>thread/post</h3>\n\t\t\t<p>書き込みできる属性が見れます。\n\t\t\tacmeなどで開いて、そのまま使えます。</p>\n\t\t\t<pre><code>from:\nmail:</code></pre>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>board/post</h3>\n\t\t\t<p>ほとんどthread/postと同じですが、\n\t\t\t属性にsubject:thread subjectが追加されています。</p>\n\t\t\t<p>日本語文字はUTF-8で書いてください。monafsが変換します。\n\t\t\t書き込みされた掲示板は、自動的にecho refresh &gt;ctlされます。</p>\n\t\t</section>\n\t</section>\n\t<section>\n\t\t<h2>EXTRA</h2>\n\t\t<p>rc/以下に、おまけのプログラムを用意してみました。\n\t\t詳しくはrc/READMEを読んでください。</p>\n\t</section>\n\t<section>\n\t\t<h2>BUGS</h2>\n\t\t<p>まちBBSには対応してません。</p>\n\t\t<p>monafsのリリース以降、2chに仕様変更が起こったため\n\t\t現在おそらく書き込みできません。時間のあるときに修正します。</p>\n\t\t<p>バグなどはこちらまで &lt;lufia@lufia.org&gt;</p>\n\t</section>\n\t<section>\n\t\t<h2>TODO</h2>\n\t\t<p>思いついたものを列挙してみました。</p>\n\t\t<section>\n\t\t\t<h3>サーバに優しく</h3>\n\t\t\t<ul>\n\t\t\t<li>gzip圧縮に対応</li>\n\t\t\t<li>If-Modified-Sinceで更新を調べる</li>\n\t\t\t<li>差分だけ読み込む</li>\n\t\t\t</ul>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>仕様へ追いつく。</h3>\n\t\t\t<ul>\n\t\t\t<li>ID:xxxx BE:xxxx</li>\n\t\t\t<li>subbbs.cgiの廃止</li>\n\t\t\t</ul>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>埋め込み設定を別ファイルにする。</h3>\n\t\t\t<ul>\n\t\t\t<li>実体参照テーブル</li>\n\t\t\t<li>書き込み判定文字</li>\n\t\t\t</ul>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>外部板に対応</h3>\n\t\t\t<ul>\n\t\t\t<li>まちBBS</li>\n\t\t\t<li>したらば、JBBS</li>\n\t\t\t</ul>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>ほか</h3>\n\t\t\t<ul>\n\t\t\t<li>●(有料)IDに対応</li>\n\t\t\t<li>BEに対応。</li>\n\t\t\t</ul>\n\t\t</section>\n\t</section>\n</main>\n<aside>\n\t<h1>関連リンク</h1>\n\t<ul>\n\t<li><a href=\"http://c.p9c.info/plan9/\">9ch(acme用2chブラウザ)</a></li>\n\t</ul>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}