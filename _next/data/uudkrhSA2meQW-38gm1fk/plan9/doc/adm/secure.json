{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>Plan 9: TLS1.2に対応させる</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"/plan9/doc/inst/index.html\">インストール</a></li>\n\t<li><a href=\"/plan9/doc/guide/index.html\">システムの使い方</a></li>\n\t<li><a href=\"/plan9/doc/devel/index.html\">プログラミング</a></li>\n\t<li><a href=\"/plan9/doc/adm/index.html\">システム管理</a></li>\n\t<li><a href=\"/plan9/man/index.html\">自作ツール集</a></li>\n\t</ul>\n</nav>\n<main>\n\t<p class=\"revision\">2015年11月8日更新</p>\n\t<section>\n\t\t<h1>TLS1.2に対応させる</h1>\n\t\t<p>現在はECDHE対応していないため無理ですが、TLS 1.2対応なら可能です。</p>\n\t\t<section>\n\t\t\t<h2>前提</h2>\n\t\t\t<ul>\n\t\t\t<li>TLS 1.2以上に対応すること</li>\n\t\t\t<li>特定の暗号方式に対応すること</li>\n\t\t\t<li>サーバ証明書がSHA256以上の署名を持っていること</li>\n\t\t\t<li>サーバ証明書が2048bit以上のRSA鍵または256bit以上のECC鍵を持っていること</li>\n\t\t\t</ul>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>TLS 1.2と許可された暗号方式に対応</h2>\n\t\t\t<section>\n\t\t\t\t<h3>ソースコード更新</h3>\n\t\t\t\t<p>9legacyのパッチを当てる。</p>\n\t\t\t\t<ul>\n\t\t\t\t<li>libsec-tlshand-nossl3</li>\n\t\t\t\t<li>libsec-x509-sha256rsa</li>\n\t\t\t\t<li>tls-devtls12</li>\n\t\t\t\t</ul>\n\t\t\t\t<p>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256に対応する形となる。</p>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<h3>ビルド</h3>\n\t\t\t\t<ul>\n\t\t\t\t<li>カーネル(devtls)</li>\n\t\t\t\t<li>libsec</li>\n\t\t\t\t<li>libsecを使ったコマンド類</li>\n\t\t\t\t</ul>\n\t\t\t\t<p>カーネルは対応が終われば、hashalgsにsha256が追加される。\n\t\t\t\tencalgsはデフォルトのまま。</p>\n\t\t\t\t<pre><code class=\"console\"># cat '#a'/tls/hashalgs\nclear md5 sha1 sha256\n# cat '#a'/tls/encalgs\nclear rc4_128 3des_ede_cbc aes_128_cbc aes_256_cbc</code></pre>\n\t\t\t\t<p class=\"note\"><strong>libsec.h</strong>をincludeしているコマンド、\n\t\t\t\tcpu, hget, import, tlsclient等いっぱいあるなあ...\n\t\t\t\tとりあえずはhget, httpd, smtpd, tlssrv, tlsclientが対応していればいいか。</p>\n\t\t\t\t<pre><code class=\"console\"># cd /sys/src/libsec\n# mk (/$objtype/lib/libsec.aが更新される)</code></pre>\n\t\t\t\t<pre><code class=\"console\"># cd /sys/src/cmd\n# mk hget.install</code></pre>\n\t\t\t\t<pre><code class=\"console\"># cd /sys/src/cmd/ip/httpd\n# mk install</code></pre>\n\t\t\t</section>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>証明書の更新</h2>\n\t\t\t<p>SHA256以上の署名を持った2048bitのRSA鍵持ち証明書を作る。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>動作確認</h2>\n\t\t\t<ul>\n\t\t\t<li><a href=\"https://www.ssllabs.com/ssltest/\">SSL Server Test</a></li>\n\t\t\t</ul>\n\t\t</section>\n\t</section>\n</main>\n<aside>\n\t<h1>参考ページ</h1>\n\t<ul>\n\t<li><a href=\"http://www.slideshare.net/tech_jstream/iosats\">Apple iOS9 (ATS)への対応</a></li>\n\t</ul>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}