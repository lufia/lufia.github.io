{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>Plan 9: バックアップ</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"/plan9/doc/inst/index.html\">インストール</a></li>\n\t<li><a href=\"/plan9/doc/guide/index.html\">システムの使い方</a></li>\n\t<li><a href=\"/plan9/doc/devel/index.html\">プログラミング</a></li>\n\t<li><a href=\"/plan9/doc/adm/index.html\">システム管理</a></li>\n\t<li><a href=\"/plan9/man/index.html\">自作ツール集</a></li>\n\t</ul>\n</nav>\n<main>\n\t<p class=\"revision\">2009年9月5日更新</p>\n\t<section>\n\t\t<h1>バックアップ</h1>\n\t\t<p>Plan 9には、fsにしてもfossil+ventiにしても、\n\t\t日々のバックアップは自動で残すようになっています。\n\t\tなので、それほど必要ではありませんが、たとえば災害に備えて\n\t\t外部メディアに予備を残しておくというのは悪いことではありません。</p>\n\t\t<p>以下いくつかサンプルを書いていますが、どれも</p>\n\t\t<ol>\n\t\t<li>生のファイルを見えるようにする。</li>\n\t\t<li><em>mkfs</em>を使って、バックアップを取る。</li>\n\t\t<li>後片付け</li>\n\t\t</ol>\n\t\t<p>という手順になっています。</p>\n\t\t<section>\n\t\t\t<h2>fsを/にマウントしている場合</h2>\n\t\t\t<pre><code class=\"console\">% mount /srv/boot /n/fs\nfs: allow\n% disk/mkfs -a -u /n/fs/adm/users -s /n/fs \\\n\t/sys/lib/sysconfig/proto/allproto &gt;plan9.20090905\nfs: disallow\n% unmount /n/fs</code></pre>\n\t\t\t<p>この場合、バックアップは1つのファイルになります。\n\t\t\tもしCDなどに焼いて、他のシステムからもそのまま閲覧したい場合は、\n\t\t\t上記の<em>disk/mkfs</em>行を以下と差し替えます。</p>\n\t\t\t<pre><code class=\"console\">% disk/mk9660 -9cj -s /n/fs \\\n\t-p /sys/lib/sysconfig/proto/allproto plan9.iso</code></pre>\n\t\t\t<p>これでCDイメージを直接作成できますので、あとは焼くだけです。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>kfsの場合</h2>\n\t\t\t<p>この例では、直接CD-Rに書き込みしています。</p>\n\t\t\t<pre><code class=\"console\">% mount /srv/kfs /n/kfs\n% disk/kfscmd allow\n% disk/mkfs -a -u files/adm.users -s /n/kfs \\\n\t/sys/lib/sysconfig/proto/allproto &gt;/mnt/cd/wd/plan9.20090905\n% disk/kfscmd disallow\n% unmount /n/kfs</code></pre>\n\t\t</section>\n\t</section>\n\t<section>\n\t\t<h1>リストア</h1>\n\t\t<p>ここでは<em>disk/mkfs</em>で作成したバックアップを展開する場合です。</p>\n\t\t<section>\n\t\t\t<h2>fsに展開する場合</h2>\n\t\t\t<p>展開先のホスト名をfsとして、\n\t\t\tさらにfsはまっさらな状態(ream直後)とします。</p>\n\t\t\t<pre><code class=\"console\">% srv fs\n% mount /srv/fs /n/fs\nfs: allow\nfs: users default\n% disk/mkext -u -d /n/fs /adm/users &lt;plan9.20090905\nfs: users\n% disk/mkext -u -d /n/fs &lt;plan9.20090905</code></pre>\n\t\t\t<p>上記の例で<em>disk/mkext</em>を2度使っているのは、\n\t\t\tfsにユーザ情報を読み込ませないと標準以外の所有者・グループ等を\n\t\t\tうまく復元してくれないためです。1回目でユーザ情報を復元して、\n\t\t\tその後<em>users</em>コマンドでfsカーネルのテーブルに読み込んでいます。</p>\n\t\t</section>\n\t</section>\n</main>\n<aside>\n\t<section>\n\t\t<h1>関連情報</h1>\n\t\t<ul>\n\t\t<li><a href=\"../guide/disc.html\">CDの取り扱い</a></li>\n\t\t</ul>\n\t</section>\n\t<section>\n\t\t<h1>参考ページ</h1>\n\t\t<ul>\n\t\t<li><a href=\"https://9p.io/magic/man2html/8/mkfs\">mkfs(8)</a></li>\n\t\t<li><a href=\"https://9p.io/magic/man2html/8/mk9660\">mk9660(8)</a></li>\n\t\t</ul>\n\t</section>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}