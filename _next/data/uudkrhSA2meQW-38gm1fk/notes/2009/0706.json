{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>orange/note: AJAXSLTを使ってみた</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/notes/index.html\">orange/note</a></li>\n\t<li><a href=\"/notes/pc.html\">PC関連</a></li>\n\t<li><a href=\"/notes/web.html\">web製作</a></li>\n\t<li><a href=\"/notes/sec.html\">セキュリティ</a></li>\n\t<li><a href=\"/notes/hobby.html\">本・ゲーム</a></li>\n\t<li><a href=\"/notes/junk.html\">ジャンク</a></li>\n\t</ul>\n</nav>\n<main>\n\t<p class=\"revision\">2009年7月6日作成</p>\n\t<section>\n\t\t<h1>AJAXSLTを使ってみた</h1>\n\t\t<p><a href=\"http://goog-ajaxslt.sourceforge.net/\">AJAXSLT</a>は、\n\t\t全部JavaScriptで書かれたXSLTライブラリです。\n\t\tJavaScriptからXSLTプロセッサを呼べないSafariやOperaにも\n\t\t対応しているとあったので、使ってみたのですが。。。</p>\n\t\t<p>XMLの名前空間をよく理解していないのもあるので、\n\t\tそう感じただけなのかもしれませんが、\n\t\tAJAXSLTの動作に理不尽なものを感じたのでもう使わないです。\n\t\tたぶん、根本的な原因はIEにあるのでしょうけど。</p>\n\t\t<p>以下やってみたこと。淡々といきます。</p>\n\t\t<section>\n\t\t\t<h2>文字列からxmlParseを使ってデータを作る場合</h2>\n\t\t\t<p>データはAtomを使うことにするので、\n\t\t\t名前空間とルートノードは次のようになる。</p>\n\t\t\t<pre><code class=\"js\">atom = '&lt;feed xmlns=&quot;http://www.w3.org/2005/Atom&quot;&gt;' +\n\t'&lt;/feed&gt;'</code></pre>\n\t\t\t<p>次に、XSLTの中で、Atom名前空間をatomとする。</p>\n\t\t\t<pre><code class=\"js\">xslt = '&lt;xsl:stylesheet version=&quot;1.0&quot;' +\n\t'\txmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;'\n\t'\txmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;'</code></pre>\n\t\t\t<p>この条件で、Atomのfeed要素にマッチさせるには、\n\t\t\tIEやFirefoxのXSLTプロセッサでは以下のように書く。</p>\n\t\t\t<pre><code class=\"xml\">&lt;xsl:template match=&quot;atom:feed&quot;&gt;</code></pre>\n\t\t\t<p>ここの名前空間は省略できない。XSLTで使うXPathは、\n\t\t\t名前空間を省略した場合にはデフォルトではなく、\n\t\t\t名前空間無しとして扱われるため。</p>\n\t\t\t<p>AJAXSLTでは、上記の書き方ではマッチしない。\n\t\t\t次の書き方になる。</p>\n\t\t\t<pre><code class=\"xml\">&lt;xsl:template match=&quot;feed&quot;&gt;</code></pre>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>外部ファイルから読み込む場合</h2>\n\t\t\t<p>上記のデータをそのまま使い、atom.xmlを作成する。\n\t\t\tサーバから返すcontent-typeはapplication/xml。</p>\n\t\t\t<pre><code class=\"xml\">&lt;feed xmlns=&quot;http://www.w3.org/2005/Atom&quot;&gt;\n&lt;/feed&gt;</code></pre>\n\t\t\t<p>次にindex.xslt。これもapplication/xml。\n\t\t\tもちろんmatchで使うXPathには、名前空間を書いてはいけない。</p>\n\t\t\t<pre><code class=\"xml\">&lt;xsl:stylesheet version=&quot;1.0&quot;\n\txmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;\n\txmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;</code></pre>\n\t\t\t<p>これらのデータを、jQuery.getを使って読み込み、\n\t\t\txsltProcessに渡すと、Safari4では期待通り動作するが、\n\t\t\tIE8ではxsltProcessの結果が空文字列となり、うまくいかない。\n\t\t\tjQuery.getの第4引数を使うと、読み込むフォーマットを\n\t\t\t文字列やXML、JSON等から選べるので、\n\t\t\t取得形式を文字列(text)に変更。\n\t\t\tその文字列からxmlParse、xsltProcessを使っても結果は変わらず。\n\t\t\t特にエラーが出ているわけでもないので原因不明。</p>\n\t\t</section>\n\t</section>\n</main>\n<aside>\n\t<h1>参考ページ</h1>\n\t<ul>\n\t<li><a href=\"http://www.asahi-net.or.jp/~ps8a-okzk/xml/memo/hint_xslt.html\">Hints for XSLT Troubles</a></li>\n\t</ul>\n</aside>\n<aside>\n\t<h1>やっていること</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"http://web.me.com/lufia/alefcompiler/alef/\">Alefコンパイラを読む</a></li>\n\t</ul>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}