{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>orange/note: Excelメモ</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/notes/index.html\">orange/note</a></li>\n\t<li><a href=\"/notes/pc.html\">PC関連</a></li>\n\t<li><a href=\"/notes/web.html\">web製作</a></li>\n\t<li><a href=\"/notes/sec.html\">セキュリティ</a></li>\n\t<li><a href=\"/notes/hobby.html\">本・ゲーム</a></li>\n\t<li><a href=\"/notes/junk.html\">ジャンク</a></li>\n\t</ul>\n</nav>\n<main>\n\t<p class=\"revision\">2011年7月8日作成</p>\n\t<section>\n\t\t<h1>Excelメモ</h1>\n\t\t<p>セルをコピーするとアドレスをずらしてくれるのは、\n\t\tだいたいの場合にとても便利ですが、\n\t\t相対アドレスのままシフトせずにコピーしたいときもありまして。</p>\n\t\t<p>まあ、全部手作業でやればいいかなあとも考えましたが、\n\t\t件数が多くてめんどくさかったので固定コピー機能を書きました。\n\t\tこれを<a href=\"http://allabout.co.jp/gm/gc/297809/\">個人用マクロブック</a>に置いて、\n\t\tAbsoluteCopyにCtl+Y、AbsolutePasteにCtl+Pあたりを割り当てました。\n\t\tマクロメニューから呼び出すと、マクロが呼び出された時点で\n\t\tExcelからみえるクリップボードが消えているためショートカットキー必須です。</p>\n\t\t<pre><code>Sub AbsoluteCopy()\n\tDim p As Range\n\tDim p1 As Range\n\tDim w As Worksheet\n\tDim w1 As Worksheet\n\tDim addr As String\n\t\n\taddr = Selection.Address\t' CreateTempの結果、アドレスが変わるので退避\n\tSelection.Copy\n\tSet w = ActiveSheet\n\tSet w1 = CreateTemp(&quot;tmp&quot;)\n\tSet p = w1.Range(addr)\n\tp.PasteSpecial\n\tFor Each p1 In p\n\t\tIf p1.HasFormula Then\n\t\t\tp1.Formula = Application.ConvertFormula(p1.Formula, xlA1, , xlAbsolute)\n\t\tEnd If\n\tNext\n\tp.Copy\n\tw.Activate\n\tDebug.Print Application.ClipboardFormats(1)\nEnd Sub\n\nSub AbsolutePaste()\n\tDim p1 As Range\n\t\n\tSelection.PasteSpecial\n\tFor Each p1 In Selection\n\t\tIf p1.HasFormula Then\n\t\t\tp1.Formula = Application.ConvertFormula(p1.Formula, xlA1, xlA1, xlRelative)\n\t\tEnd If\n\tNext\nEnd Sub\n\nFunction CreateTemp(ByVal s As String) As Worksheet\n\tDim i As Integer\n\tDim w As Worksheet\n\t\n\tIf Not IsExist(s) Then\n\t\tSet w = ThisWorkbook.Sheets.Add()\n\t\tw.Name = s\n\t\tSet CreateTemp = w\n\t\tExit Function\n\tEnd If\n\t\n\ti = 1\n\tDo While IsExist(s &amp; i)\n\t\ti = i + 1\n\tLoop\n\t\n\tSet w = ThisWorkbook.Sheets.Add()\n\tw.Name = s &amp; i\n\tSet CreateTemp = w\nEnd Function\n\nFunction IsExist(ByVal s As String) As Boolean\n\tDim i As Integer\n\t\n\tFor i = 1 To ThisWorkbook.Sheets.Count\n\t\tIf ThisWorkbook.Sheets(i).Name = s Then\n\t\t\tIsExist = True\n\t\t\tExit Function\n\t\tEnd If\n\tNext\n\tIsExist = False\nEnd Function</code></pre>\n\t</section>\n</main>\n<aside>\n\t<h1>関連情報</h1>\n\t<ul>\n\t<li><a href=\"http://www.officetanaka.net/excel/vba/tips/tips117.htm\">相対参照と絶対参照を変換する</a></li>\n\t</ul>\n</aside>\n<aside>\n\t<h1>やっていること</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"http://web.me.com/lufia/alefcompiler/alef/\">Alefコンパイラを読む</a></li>\n\t</ul>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}