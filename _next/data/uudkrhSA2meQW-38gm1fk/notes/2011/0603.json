{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>orange/note: ASP.NET関連のいろいろまとめ</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/notes/index.html\">orange/note</a></li>\n\t<li><a href=\"/notes/pc.html\">PC関連</a></li>\n\t<li><a href=\"/notes/web.html\">web製作</a></li>\n\t<li><a href=\"/notes/sec.html\">セキュリティ</a></li>\n\t<li><a href=\"/notes/hobby.html\">本・ゲーム</a></li>\n\t<li><a href=\"/notes/junk.html\">ジャンク</a></li>\n\t</ul>\n</nav>\n<main>\n\t<p class=\"revision\">2011年7月14日更新</p>\n\t<section>\n\t\t<h1>ASP.NET関連のいろいろまとめ</h1>\n\t\t<section>\n\t\t\t<h2>WCF Data Services</h2>\n\t\t\t<p>WCF RIA Servicesで子テーブルを含む場合は.Include()ですが、\n\t\t\tWCF Data Servicesでは.Expand()を使います。\n\t\t\t同じ作業なのにいちいち名前が違っていてめんどくさい。。。</p>\n\t\t\t<p>ちなみにExpand()は、$expand=xxxに渡す文字列を引数に書きます。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>ASP.NET MVC2</h2>\n\t\t\t<p>はじめてつかった。</p>\n\t\t\t<section>\n\t\t\t\t<h3>JSONを返す</h3>\n\t\t\t\t<p>コントローラからJSONを返すには、\n\t\t\t\t戻り値の型をJsonResultに変えて(通常はActionResult)、\n\t\t\t\tJsonヘルパメソッドの戻り値を返します。</p>\n\t\t\t\t<pre><code class=\"cs\">public PartialViewResult Index()\n{\n\tvar q = from c in ctxt.Items select c;\n\treturn Json(q, [JsonRequestBehavior]);\n}</code></pre>\n\t\t\t\t<p>それから、コントローラの中からクエリ文字列をみるには、\n\t\t\t\tRequest.QueryString[]を調べるといいみたい。</p>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<h3>ユーザコントロールを使う</h3>\n\t\t\t\t<p>コントローラの戻り値をPartialViewResultに変更して、\n\t\t\t\tPartialView()により作成されたものを返すように作ります。</p>\n\t\t\t\t<pre><code class=\"cs\">public PartialViewResult Index()\n{\n\tvar q = from c in ctxt.Items select c;\n\treturn PartialView(q);\n}</code></pre>\n\t\t\t\t<p>次に、Html.Action()を使ってその結果を取り込みます。</p>\n\t\t\t\t<pre><code class=\"xml\">&lt;%: Html.Action(&quot;Index&quot;, &quot;Controller1&quot;) %&gt;</code></pre>\n\t\t\t\t<p>単純な取り込みでよければ、\n\t\t\t\tページの最初あたりでコントロールを登録すると使えるようにります。</p>\n\t\t\t\t<pre><code class=\"xml\">&lt;%@ Register TagPrefix=&quot;my&quot;\n TagName=&quot;ctl1&quot;\n Src=&quot;~/Views/Controller1/Index.ascx&quot; %&gt;</code></pre>\n\t\t\t\t<p>runat=&quot;server&quot;は必須です。</p>\n\t\t\t\t<pre><code class=\"xml\">&lt;my:ctl1 runat=&quot;server&quot;/&gt;</code></pre>\n\t\t\t\t<p>ただしこの場合、ユーザコントロールの中でModelを参照すると、\n\t\t\t\t呼び出し元のModelをそのまま参照してしまいます。\n\t\t\t\tあまり使い道はなさそうです。</p>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<h3>相対URL</h3>\n\t\t\t\t<p>開発環境と実環境でパスが異なる場合、絶対パスは使えないし、\n\t\t\t\t同じビューが異なるURLで使われたりするので厳しい。\n\t\t\t\tこういうとき、Url.Content(string path)を使います。\n\t\t\t\tこれはpathが~/ではじまっている場合、\n\t\t\t\t正しいURLへ書き換えてくれます。</p>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<h3>URLの部分取得</h3>\n\t\t\t\t<p>Controller/Action/idなどから、\n\t\t\t\tidのような特定部分を取り出したい場合、\n\t\t\t\tRequest[&quot;id&quot;]のように調べると見れます。\n\t\t\t\tまたは、ViewData[&quot;id&quot;]とか。</p>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<h3>?Length=7</h3>\n\t\t\t\t<pre><code class=\"cs\">Html.ActionLink(&quot;Action&quot;, &quot;Controller&quot;, new{ id=3 })</code></pre>\n\t\t\t\t<p>このようにすると、Home/Action?Length=7という\n\t\t\t\tどこに設定したのだか分からないパラメータ付きURLになります。\n\t\t\t\tこれはメソッドのオーバーロードが悪さをしているらしいので、\n\t\t\t\t全部パラメータを与えてあげれば解決です。</p>\n\t\t\t\t<pre><code class=\"cs\">Html.ActionLink(&quot;Action&quot;, &quot;Controller&quot;, new{ id=3 }, new{})</code></pre>\n\t\t\t\t<p>ここでnew{}の代わりにnullを使うとうまくないっぽい。</p>\n\t\t\t</section>\n\t\t\t<section>\n\t\t\t\t<h3>戻りURL</h3>\n\t\t\t\t<p>コントローラで何かを処理した後の戻りURL、\n\t\t\t\tたとえば削除したときに戻る先はどうするの、という話。</p>\n\t\t\t\t<section>\n\t\t\t\t\t<h4>UrlReferrerを使う</h4>\n\t\t\t\t\t<p>単純に戻る場合はUrlReferrerをみればいいです。\n\t\t\t\t\tただし、URLを直接入力した場合はnullなので使いづらい。</p>\n\t\t\t\t\t<pre><code class=\"cs\">if(Request.UrlReferrer != null)\n\tRedirect(Request.UrlReferrer.AbsolutePath);</code></pre>\n\t\t\t\t</section>\n\t\t\t\t<section>\n\t\t\t\t\t<h4>戻りURLパラメータを渡す</h4>\n\t\t\t\t\t<p>RedirectToUrlのようなパラメータにフォーム等で渡す方法。</p>\n\t\t\t\t\t<pre><code class=\"xml\">&lt;% using(Html.BeginForm()) { %&gt;\n\t&lt;%: Html.Hidden(&quot;redirectToUrl&quot;, &quot;...&quot;) %&gt;\n&lt;% } %&gt;</code></pre>\n\t\t\t\t\t<p>コントローラ側では、引数として受け取る。</p>\n\t\t\t\t\t<pre><code class=\"cs\">public ActionResult Action1(string redirectToUrl)\n{\n\t...\n}</code></pre>\n\t\t\t\t</section>\n\t\t\t</section>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>jQuery.autocomplete(url, option)</h2>\n\t\t\t<p>autocompleteは、urlからデータを読み込み、\n\t\t\tその内容をもとに表示します。\n\t\t\tこのデータは|で区切った行の集まりです。\n\t\t\tまた、urlはQUERY_STRINGに&quot;q=(検索文字列)&quot;を渡すので、\n\t\t\tデータを絞り込むのにそれが使えます。</p>\n\t\t\t<pre><code>key1|value1\nkey2|value2\n...</code></pre>\n\t\t\t<p>配列をもとにオートコンプリートする場合は、\n\t\t\tautocomplete()の代わりにautocompleteArray()を使います。</p>\n\t\t\t<p>オプションはいろいろありますが、よく使うものを例に書きました。</p>\n\t\t\t<pre><code class=\"js\">$(document).ready(function(){\n\t$('#target').autocomplete(url, {\n\t\tmax: 25,\n\t\tformatItem: function(r){ return r[1] },\n\t\tformatResult: function(r){ return r[1] }\n\t}).result(function(e, r){\n\t\tlocation.href = r[0]\n\t})\n})</code></pre>\n\t\t\t<p>result()は一覧から選択したときに関数を実行します。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>jQuery.dataTables</h2>\n\t\t\t<p>いろいろありすぎてよくわからない。</p>\n\t\t\t<ul>\n\t\t\t<li><a href=\"http://www.sprymedia.co.uk/article/DataTables\">オプション一覧っぽいもの</a></li>\n\t\t\t</ul>\n\t\t</section>\n\t</section>\n</main>\n<aside>\n\t<section>\n\t\t<h1>関連ページ</h1>\n\t\t<ul>\n\t\t<li><a href=\"0607.html\">ASP.NETページ構文とHTMLヘルパ</a></li>\n\t\t</ul>\n\t</section>\n\t<section>\n\t\t<h1>参考サイト</h1>\n\t\t<ul>\n\t\t<li><a href=\"http://msdn.microsoft.com/ja-jp/asp.net/gg490787\">コードで学ぶ ASP.NET MVC アプリケーション開発入門</a></li>\n\t\t<li><a href=\"http://www.atmarkit.co.jp/fdotnet/aspnetmvc/index/index.html\">ASP.NET MVC入門</a></li>\n\t\t<li><a href=\"http://d.hatena.ne.jp/shiba-yan/20110208/1297096899\">ASP.NET MVC 3開発入門</a></li>\n\t\t<li><a href=\"http://msdn.microsoft.com/ja-jp/asp.net/gg315881.aspx\">ASP.NET Music Storeチュートリアル</a></li>\n\t\t<li><a href=\"http://d.hatena.ne.jp/freemake/20100907/1283880424\">EditorFor、DisplayForで使用されるカスタムテンプレート</a></li>\n\t\t</ul>\n\t</section>\n</aside>\n<aside>\n\t<h1>やっていること</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"http://web.me.com/lufia/alefcompiler/alef/\">Alefコンパイラを読む</a></li>\n\t</ul>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}