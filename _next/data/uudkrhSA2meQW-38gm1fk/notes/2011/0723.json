{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>orange/note: VMware Playerにファイルサーバをインストール</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/notes/index.html\">orange/note</a></li>\n\t<li><a href=\"/notes/pc.html\">PC関連</a></li>\n\t<li><a href=\"/notes/web.html\">web製作</a></li>\n\t<li><a href=\"/notes/sec.html\">セキュリティ</a></li>\n\t<li><a href=\"/notes/hobby.html\">本・ゲーム</a></li>\n\t<li><a href=\"/notes/junk.html\">ジャンク</a></li>\n\t</ul>\n</nav>\n<main>\n\t<p class=\"revision\">2011年7月23日作成</p>\n\t<section>\n\t\t<h1>VMware Playerにファイルサーバをインストール</h1>\n\t\t<p>紆余曲折ありまして、だいぶ苦労しましたが、\n\t\tとりあえず動くまではできました。</p>\n\t\t<p>まずは端末をインストールするのですが、\n\t\t今のPlayerでは新しい仮想マシンの作成もできるので\n\t\tqemuを使ってvmdkを作らなくてもよくなっています。\n\t\t代わりに、いろいろ試してみましたがインストール時にrioが使えないので、\n\t\tinst/textonlyで進める必要があります。\n\t\tインストールが終わればふつうに使えるのにね。</p>\n\t\t<pre><code class=\"ini\">vgasize=1024x768x24\nmonitor=xga</code></pre>\n\t\t<p>次に、fsのソースを落としてコンパイルするのですが、\n\t\tfsカーネルのE1000ドライバはVMwareのデバイスを認識しません。\n\t\tこの点についてパッチを当てた<a href=\"../../plan9/src/etherigbe.c\">etherigbe.c</a>を置いておきますので差し替えてください。\n\t\t変更したところは、定数i82545emの定義と、\n\t\t各switch文にそれを含めただけですね。</p>\n\t\t<pre><code class=\"c\">i82545em = (0x100F&lt;&lt;16)|0x8086,</code></pre>\n\t\t<div class=\"note\">\n\t\t\t<p>ファイルサーバを起動してpcihinvコマンドを使うと、\n\t\t\tデバイスのIDが見れます。</p>\n\t\t\t<pre><code>fs: pcihinv\n...\n2 0/0 0200 8086 100f 10 0:....\n...</code></pre>\n\t\t</div>\n\t\t<p>ここは<a href=\"../../plan9/doc/inst/fs.html\">ファイルサーバのインストール</a>そのまま。\n\t\tちょっとつまづいたのは2点、instに実行パーミッションが無いと\n\t\tファイルが見つからないというエラーになって動かないところと、\n\t\tplan9.iniのbootfileエントリだけは、新しい書き方を取るところ。</p>\n\t\t<pre><code class=\"ini\">ether0=type=igbe\nscsi0=type=buslogic\nbootfile=fd0!dos!9fsfs64\nnvr=fd!0!plan9.nvr</code></pre>\n\t\t<p>これでフロッピーを作ればPlan 9側の処理は終わりですが、\n\t\t最後にNICのチップセットを変更しておきます。\n\t\t具体的にはvmxファイルに以下を追加。</p>\n\t\t<pre><code class=\"ini\">ethernet0.virtualDev = &quot;e1000&quot;</code></pre>\n\t\t<p>これで、仮想マシン間でip/pingも通りましたし、\n\t\t外部のSNTPサーバとも通信ができました。\n\t\tあとは、SCSIを認識しているもののSCSIディスクの追加方法が分からないので、\n\t\tそこが確認できれば問題なさそうですね。</p>\n\t</section>\n</main>\n<aside>\n\t<h1>関連情報</h1>\n\t<ul>\n\t<li><a href=\"../../plan9/doc/inst/fs.html\">ファイルサーバのインストール</a></li>\n\t</ul>\n</aside>\n<aside>\n\t<h1>やっていること</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"http://web.me.com/lufia/alefcompiler/alef/\">Alefコンパイラを読む</a></li>\n\t</ul>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}