{"pageProps":{"html":"<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>orange/note: Accessメモ</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<meta name=\"author\" content=\"http://www.hatena.ne.jp/lufiabb/\">\n</head>\n<body>\n<nav>\n\t<h1>メニュー</h1>\n\t<ul>\n\t<li><a href=\"/notes/index.html\">orange/note</a></li>\n\t<li><a href=\"/notes/pc.html\">PC関連</a></li>\n\t<li><a href=\"/notes/web.html\">web製作</a></li>\n\t<li><a href=\"/notes/sec.html\">セキュリティ</a></li>\n\t<li><a href=\"/notes/hobby.html\">本・ゲーム</a></li>\n\t<li><a href=\"/notes/junk.html\">ジャンク</a></li>\n\t</ul>\n</nav>\n<main>\n\t<p class=\"revision\">2010年5月12日更新</p>\n\t<section>\n\t\t<h1>Accessメモ</h1>\n\t\t<section>\n\t\t\t<h2>イベントの発生順序</h2>\n\t\t\t<ol>\n\t\t\t<li>BeforeInsert</li>\n\t\t\t<li>BeforeUpdate</li>\n\t\t\t<li>AfterUpdate</li>\n\t\t\t<li>AfterInsert</li>\n\t\t\t</ol>\n\t\t\t<p>印象と違っていたのでメモ。\n\t\t\tAfterInsertのほうがAfterUpdateより先だと思ってました。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>OldValueを参照するとエラー</h2>\n\t\t\t<p>TextBox.OldValueプロパティを参照するとエラーになって割と困りました。\n\t\t\t現象としては、値がNullとかではなく、プロパティが参照できません。\n\t\t\tこれは、1対多リレーションシップのとき、\n\t\t\t1側のデータについてOldValueを調べると発生します。</p>\n\t\t\t<p>解決策は、Currentで値を残しておいて、あとからそれを調べるようにします。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>OldValueの疑問</h2>\n\t\t\t<p>たとえばTextBox.Valueを&quot;テスト&quot;から&quot;test&quot;に書き換えた場合。\n\t\t\tBeforeUpdateではOldValue=&quot;テスト&quot;でしたが、\n\t\t\tAfterUpdateになるとOldValue=&quot;test&quot;になっていました。\n\t\t\tこれは何か他の要因？それともそういう仕様？</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>BeforeInsertイベントが発生しない</h2>\n\t\t\t<p>ヘルプによると、プログラムから値を挿入した場合は発生しない、とあります。\n\t\t\tでも、たぶん。最初にどこをキックしたかによって変ってくるのではないかなあ。</p>\n\t\t\t<ul>\n\t\t\t<li>ヘルプの通り、プログラムから挿入した場合は基本的には発生しない</li>\n\t\t\t<li>最初に入力があったものがコントロールを介しての場合、プログラムからでも発生する</li>\n\t\t\t<li>新しい行の最初に値が入ったとき、がBeforeInsertのタイミング</li>\n\t\t\t<li>なので、それ以降はコントロールを介していようが発生しない</li>\n\t\t\t</ul>\n\t\t\t<p>まとめると、プログラムから扱う場合、Me!Itemがフィールドの場合は発生しないで、\n\t\t\tフィールドをバインドしたコントロールの場合は発生ということ？</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>NotInListイベント</h2>\n\t\t\t<p>ComboBox.NotInListイベントは、入力チェックが有効になっていないと反応しない。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>オートナンバーを持つテーブルをコピーする方法</h2>\n\t\t\t<p>オートナンバーをキーにしている場合、\n\t\t\t番号がずれるとリレーションも切れてしまうので調べた。</p>\n\t\t\t<p>クエリを使ってinsertすればコピーできる。\n\t\t\tその際は、元のテーブルが記録していた次の番号のほうが大きければそれ。\n\t\t\t挿入したデータのほうが大きければその次の番号となる。</p>\n\t\t\t<p>リレーションがあってもコピーできるが、順番には注意。</p>\n\t\t</section>\n\t\t<section>\n\t\t\t<h2>オートナンバーのリセット</h2>\n\t\t\t<pre><code>CurrentProject.Connection.Execute _\n\tCommandText:=&quot;Alter Table テーブル名 &quot; _\n\t\t&amp; &quot;Alter Column フィールド名 Identity( 1, 1 );&quot;</code></pre>\n\t\t\t<p>または、</p>\n\t\t\t<pre><code>DoCmd.RunSQL &quot;alter table tablename alter column columnname counter(1)&quot;</code></pre>\n\t\t\t<p>ただし、リレーションシップが張られている場合はエラーになる</p>\n\t\t</section>\n\t</section>\n</main>\n<aside>\n\t<h1>関連情報</h1>\n\t<ul>\n\t<li><a href=\"../2011/0805.html\">SQL Serverのメモ</a></li>\n\t</ul>\n</aside>\n<aside>\n\t<h1>やっていること</h1>\n\t<ul>\n\t<li><a href=\"/plan9/index.html\">Plan 9</a></li>\n\t<li><a href=\"http://web.me.com/lufia/alefcompiler/alef/\">Alefコンパイラを読む</a></li>\n\t</ul>\n</aside>\n<footer>\n\t<p>見れない、表示がおかしい場合は、動作環境を添えて<a href=\"mailto:webmaster@lufia.org\">webmaster@lufia.org</a>まで連絡ください。</p>\n</footer>\n</body>\n</html>\n"},"__N_SSG":true}